<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Teaching & Contributions</title>

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Calibri','Segoe UI',sans-serif;background:#f8f9fa;padding:20px;color:#333}
.container{max-width:1000px;margin:auto;background:#fff;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,.1);overflow:hidden;border:1px solid #ddd}
.header{background:#003366;color:#fff;padding:20px;text-align:center;border-bottom:4px solid #ffcc00}
.header h1{font-size:24px;margin-bottom:5px;font-weight:600}
.header p{font-size:14px;opacity:.9}
.form-section{padding:25px}
.section-title{color:#003366;font-size:18px;font-weight:600;margin:25px 0 15px;padding-bottom:8px;border-bottom:2px solid #e0e0e0}
.sub-section-title{color:#475569;font-size:16px;font-weight:600;margin:20px 0 10px;padding-left:10px;border-left:3px solid #003366}
label{display:block;margin-bottom:5px;color:#003366;font-weight:500;font-size:14px}
.required:after{content:" *";color:#d32f2f}
.form-control,textarea{width:100%;padding:8px 12px;border:1px solid #ccc;border-radius:4px;font-size:14px}
.subject-block,.contribution-block{background:#f5f7fa;border:1px solid #ddd;border-radius:5px;padding:15px;margin-bottom:10px;position:relative}
.subject-block:before{content:attr(data-index);position:absolute;top:-10px;left:15px;background:#003366;color:#fff;width:20px;height:20px;border-radius:50%;text-align:center;line-height:20px;font-size:12px}
.ug-block{background:#e8f4f8;border-color:#b3e0f2}
.pg-block{background:#fff8e1;border-color:#ffd54f}
.dept-block{border-left:4px solid #28a745}
.college-block{border-left:4px solid #6f42c1}
.btn{padding:8px 20px;border:none;border-radius:4px;cursor:pointer;font-size:14px}
.btn-add{background:#e9ecef;color:#003366;border:1px dashed #adb5bd;width:100%;margin:10px 0}
.btn-prev{background:#6c757d;color:#fff}
.btn-next{background:#003366;color:#fff}
.remove-btn{background:#f8d7da;color:#721c24;border:1px solid #f5c6cb;padding:5px 10px;border-radius:3px;font-size:12px;cursor:pointer;margin-top:10px}
.button-group{display:flex;justify-content:space-between;margin-top:30px;padding-top:20px;border-top:1px solid #eee}
</style>
</head>

<body>
<div class="container">
<div class="header">
<h1>Teaching & Contributions</h1>
<p>Subjects taught and institutional contributions</p>
</div>

<div class="form-section">
<form method="post">
{% csrf_token %}

<!-- ===== UG ===== -->
<h2 class="sub-section-title">Undergraduate (UG)</h2>
<div id="ug-container" class="block-container">
<div class="subject-block ug-block" data-index="1">
<label class="required">Subject & Result</label>
<input type="text" name="ug_subjects[]" class="form-control">
</div>
</div>
<button type="button" class="btn btn-add" onclick="addBlock('ug')">+ Add UG Subject</button>

<!-- ===== PG ===== -->
<h2 class="sub-section-title">Postgraduate (PG)</h2>
<div id="pg-container" class="block-container">
<div class="subject-block pg-block" data-index="1">
<label class="required">Subject & Result</label>
<input type="text" name="pg_subjects[]" class="form-control">
</div>
</div>
<button type="button" class="btn btn-add" onclick="addBlock('pg')">+ Add PG Subject</button>

<!-- ===== CONTRIBUTIONS ===== -->
<h2 class="section-title">Institutional Contributions</h2>

<h2 class="sub-section-title">Department</h2>
<div id="dept-container" class="block-container">
<div class="contribution-block dept-block">
<textarea name="department_contributions[]" class="form-control"></textarea>
</div>
</div>
<button type="button" class="btn btn-add" onclick="addBlock('dept')">+ Add Department Contribution</button>

<h2 class="sub-section-title">College</h2>
<div id="college-container" class="block-container">
<div class="contribution-block college-block">
<textarea name="college_contributions[]" class="form-control"></textarea>
</div>
</div>
<button type="button" class="btn btn-add" onclick="addBlock('college')">+ Add College Contribution</button>

<div class="button-group">
<button type="button" class="btn btn-prev" onclick="history.back()">← Previous</button>
<button type="submit" class="btn btn-next">Save & Next →</button>
</div>

</form>
</div>
</div>

<script>
function addBlock(type) {
    const map = {
        ug: ['ug-container','ug-block','input'],
        pg: ['pg-container','pg-block','input'],
        dept: ['dept-container','dept-block','textarea'],
        college: ['college-container','college-block','textarea']
    };

    const [cid, cls, tag] = map[type];
    const container = document.getElementById(cid);
    const clone = container.firstElementChild.cloneNode(true);

    clone.querySelector(tag).value = "";

    // add remove button ONLY for added blocks
    const removeBtn = document.createElement("button");
    removeBtn.type = "button";
    removeBtn.className = "remove-btn";
    removeBtn.textContent = "Remove";
    removeBtn.onclick = function () {
        removeBlock(this);
    };
    clone.appendChild(removeBtn);

    container.appendChild(clone);
    updateIndex(container);
}

function removeBlock(btn) {
    const container = btn.closest(".block-container");
    btn.parentElement.remove();

    // hide remove if only one block left
    if (container.children.length === 1) {
        const rb = container.firstElementChild.querySelector(".remove-btn");
        if (rb) rb.remove();
    }
    updateIndex(container);
}

function updateIndex(container) {
    [...container.children].forEach((block, i) => {
        block.setAttribute("data-index", i + 1);
    });
}
</script>

</body>
</html>
